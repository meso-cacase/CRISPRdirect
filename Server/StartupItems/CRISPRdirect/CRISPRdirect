#!/bin/sh
#
# /Library/StartupItems/CRISPRdirect/CRISPRdirect
#
# A startup script of CRISPRdirect jellyfish server for Mac OS X.

. /etc/rc.common

JELFISH="/opt/CRISPRdirect/jellyfishd.pl"
HASHDIR="/genome/jellyhash"
LOGDIR="/genome/jellylog"

StartService ()
{
	ConsoleMessage "Starting CRISPRdirect jellyfish server"

	sudo -u nobody $JELFISH -p 48001 -hash $HASHDIR/hg38/*.jf >> $LOGDIR/hg38.log 2>&1 &
	sudo -u nobody $JELFISH -p 48002 -hash $HASHDIR/hg19/*.jf >> $LOGDIR/hg19.log 2>&1 &
	sudo -u nobody $JELFISH -p 48003 -hash $HASHDIR/hg18/*.jf >> $LOGDIR/hg18.log 2>&1 &
	sudo -u nobody $JELFISH -p 48004 -hash $HASHDIR/mm10/*.jf >> $LOGDIR/mm10.log 2>&1 &
	sudo -u nobody $JELFISH -p 48005 -hash $HASHDIR/mm9/*.jf >> $LOGDIR/mm9.log 2>&1 &
	sudo -u nobody $JELFISH -p 48006 -hash $HASHDIR/rn6/*.jf >> $LOGDIR/rn6.log 2>&1 &
	sudo -u nobody $JELFISH -p 48007 -hash $HASHDIR/rn5/*.jf >> $LOGDIR/rn5.log 2>&1 &
	sudo -u nobody $JELFISH -p 48027 -hash $HASHDIR/calJac3/*.jf >> $LOGDIR/calJac3.log 2>&1 &
	sudo -u nobody $JELFISH -p 48036 -hash $HASHDIR/susScr3/*.jf >> $LOGDIR/susScr3.log 2>&1 &
	sudo -u nobody $JELFISH -p 48053 -hash $HASHDIR/allMis1/*.jf >> $LOGDIR/allMis1.log 2>&1 &
	sudo -u nobody $JELFISH -p 48054 -hash $HASHDIR/gadMor1/*.jf >> $LOGDIR/gadMor1.log 2>&1 &
	sudo -u nobody $JELFISH -p 48055 -hash $HASHDIR/melUnd1/*.jf >> $LOGDIR/melUnd1.log 2>&1 &
	sudo -u nobody $JELFISH -p 48056 -hash $HASHDIR/galGal4/*.jf >> $LOGDIR/galGal4.log 2>&1 &
	sudo -u nobody $JELFISH -p 48057 -hash $HASHDIR/latCha1/*.jf >> $LOGDIR/latCha1.log 2>&1 &
	sudo -u nobody $JELFISH -p 48058 -hash $HASHDIR/calMil1/*.jf >> $LOGDIR/calMil1.log 2>&1 &
	sudo -u nobody $JELFISH -p 48059 -hash $HASHDIR/fr3/*.jf >> $LOGDIR/fr3.log 2>&1 &
	sudo -u nobody $JELFISH -p 48060 -hash $HASHDIR/petMar2/*.jf >> $LOGDIR/petMar2.log 2>&1 &
	sudo -u nobody $JELFISH -p 48061 -hash $HASHDIR/anoCar2/*.jf >> $LOGDIR/anoCar2.log 2>&1 &
	sudo -u nobody $JELFISH -p 48062 -hash $HASHDIR/oryLat2/*.jf >> $LOGDIR/oryLat2.log 2>&1 &
	sudo -u nobody $JELFISH -p 48063 -hash $HASHDIR/geoFor1/*.jf >> $LOGDIR/geoFor1.log 2>&1 &
	sudo -u nobody $JELFISH -p 48064 -hash $HASHDIR/oreNil2/*.jf >> $LOGDIR/oreNil2.log 2>&1 &
	sudo -u nobody $JELFISH -p 48065 -hash $HASHDIR/chrPic1/*.jf >> $LOGDIR/chrPic1.log 2>&1 &
	sudo -u nobody $JELFISH -p 48066 -hash $HASHDIR/gasAcu1/*.jf >> $LOGDIR/gasAcu1.log 2>&1 &
	sudo -u nobody $JELFISH -p 48067 -hash $HASHDIR/tetNig2/*.jf >> $LOGDIR/tetNig2.log 2>&1 &
	sudo -u nobody $JELFISH -p 48068 -hash $HASHDIR/melGal1/*.jf >> $LOGDIR/melGal1.log 2>&1 &
	sudo -u nobody $JELFISH -p 48069 -hash $HASHDIR/xenTro3/*.jf >> $LOGDIR/xenTro3.log 2>&1 &
	sudo -u nobody $JELFISH -p 48070 -hash $HASHDIR/taeGut2/*.jf >> $LOGDIR/taeGut2.log 2>&1 &
	sudo -u nobody $JELFISH -p 48071 -hash $HASHDIR/danRer7/*.jf >> $LOGDIR/danRer7.log 2>&1 &
	sudo -u nobody $JELFISH -p 48072 -hash $HASHDIR/ci2/*.jf >> $LOGDIR/ci2.log 2>&1 &
	sudo -u nobody $JELFISH -p 48073 -hash $HASHDIR/braFlo1/*.jf >> $LOGDIR/braFlo1.log 2>&1 &
	sudo -u nobody $JELFISH -p 48074 -hash $HASHDIR/strPur2/*.jf >> $LOGDIR/strPur2.log 2>&1 &
	sudo -u nobody $JELFISH -p 48075 -hash $HASHDIR/anoGam1/*.jf >> $LOGDIR/anoGam1.log 2>&1 &
	sudo -u nobody $JELFISH -p 48076 -hash $HASHDIR/apiMel2/*.jf >> $LOGDIR/apiMel2.log 2>&1 &
	sudo -u nobody $JELFISH -p 48077 -hash $HASHDIR/droAna2/*.jf >> $LOGDIR/droAna2.log 2>&1 &
	sudo -u nobody $JELFISH -p 48078 -hash $HASHDIR/droEre1/*.jf >> $LOGDIR/droEre1.log 2>&1 &
	sudo -u nobody $JELFISH -p 48079 -hash $HASHDIR/droGri1/*.jf >> $LOGDIR/droGri1.log 2>&1 &
	sudo -u nobody $JELFISH -p 48080 -hash $HASHDIR/dm6/*.jf >> $LOGDIR/dm6.log 2>&1 &
	sudo -u nobody $JELFISH -p 48081 -hash $HASHDIR/dm3/*.jf >> $LOGDIR/dm3.log 2>&1 &
	sudo -u nobody $JELFISH -p 48082 -hash $HASHDIR/droMoj2/*.jf >> $LOGDIR/droMoj2.log 2>&1 &
	sudo -u nobody $JELFISH -p 48083 -hash $HASHDIR/droPer1/*.jf >> $LOGDIR/droPer1.log 2>&1 &
	sudo -u nobody $JELFISH -p 48084 -hash $HASHDIR/dp3/*.jf >> $LOGDIR/dp3.log 2>&1 &
	sudo -u nobody $JELFISH -p 48085 -hash $HASHDIR/droSec1/*.jf >> $LOGDIR/droSec1.log 2>&1 &
	sudo -u nobody $JELFISH -p 48086 -hash $HASHDIR/droSim1/*.jf >> $LOGDIR/droSim1.log 2>&1 &
	sudo -u nobody $JELFISH -p 48087 -hash $HASHDIR/droVir2/*.jf >> $LOGDIR/droVir2.log 2>&1 &
	sudo -u nobody $JELFISH -p 48088 -hash $HASHDIR/droYak2/*.jf >> $LOGDIR/droYak2.log 2>&1 &
	sudo -u nobody $JELFISH -p 48089 -hash $HASHDIR/caePb2/*.jf >> $LOGDIR/caePb2.log 2>&1 &
	sudo -u nobody $JELFISH -p 48090 -hash $HASHDIR/cb3/*.jf >> $LOGDIR/cb3.log 2>&1 &
	sudo -u nobody $JELFISH -p 48091 -hash $HASHDIR/ce10/*.jf >> $LOGDIR/ce10.log 2>&1 &
	sudo -u nobody $JELFISH -p 48092 -hash $HASHDIR/caeJap1/*.jf >> $LOGDIR/caeJap1.log 2>&1 &
	sudo -u nobody $JELFISH -p 48093 -hash $HASHDIR/caeRem3/*.jf >> $LOGDIR/caeRem3.log 2>&1 &
	sudo -u nobody $JELFISH -p 48094 -hash $HASHDIR/priPac1/*.jf >> $LOGDIR/priPac1.log 2>&1 &
	sudo -u nobody $JELFISH -p 48095 -hash $HASHDIR/sacCer3/*.jf >> $LOGDIR/sacCer3.log 2>&1 &
	sudo -u nobody $JELFISH -p 48096 -hash $HASHDIR/aplCal1/*.jf >> $LOGDIR/aplCal1.log 2>&1 &
	sudo -u nobody $JELFISH -p 48097 -hash $HASHDIR/eboVir3/*.jf >> $LOGDIR/eboVir3.log 2>&1 &
	sudo -u nobody $JELFISH -p 48207 -hash $HASHDIR/Xenla9/*.jf >> $LOGDIR/Xenla9.log 2>&1 &
	sudo -u nobody $JELFISH -p 48208 -hash $HASHDIR/Xenla7/*.jf >> $LOGDIR/Xenla7.log 2>&1 &
	sudo -u nobody $JELFISH -p 48209 -hash $HASHDIR/Xentr9/*.jf >> $LOGDIR/Xentr9.log 2>&1 &
	sudo -u nobody $JELFISH -p 48210 -hash $HASHDIR/Xentr8/*.jf >> $LOGDIR/Xentr8.log 2>&1 &
	sudo -u nobody $JELFISH -p 48211 -hash $HASHDIR/Xentr7/*.jf >> $LOGDIR/Xentr7.log 2>&1 &
	sudo -u nobody $JELFISH -p 48212 -hash $HASHDIR/TAIR10/*.jf >> $LOGDIR/TAIR10.log 2>&1 &
	sudo -u nobody $JELFISH -p 48213 -hash $HASHDIR/rice/*.jf >> $LOGDIR/rice.log 2>&1 &
	sudo -u nobody $JELFISH -p 48214 -hash $HASHDIR/sorBic/*.jf >> $LOGDIR/sorBic.log 2>&1 &
	sudo -u nobody $JELFISH -p 48215 -hash $HASHDIR/Brana_v4.1/*.jf >> $LOGDIR/Brana_v4.1.log 2>&1 &
	sudo -u nobody $JELFISH -p 48216 -hash $HASHDIR/lotus_r3.0/*.jf >> $LOGDIR/lotus_r3.0.log 2>&1 &
	sudo -u nobody $JELFISH -p 48217 -hash $HASHDIR/Niben_v1.0.1/*.jf >> $LOGDIR/Niben_v1.0.1.log 2>&1 &
	sudo -u nobody $JELFISH -p 48218 -hash $HASHDIR/adzuki_ver3/*.jf >> $LOGDIR/adzuki_ver3.log 2>&1 &
	sudo -u nobody $JELFISH -p 48219 -hash $HASHDIR/RSA_r1.0/*.jf >> $LOGDIR/RSA_r1.0.log 2>&1 &
	sudo -u nobody $JELFISH -p 48220 -hash $HASHDIR/Ptrichocarpa_v3.0/*.jf >> $LOGDIR/Ptrichocarpa_v3.0.log 2>&1 &
	sudo -u nobody $JELFISH -p 48221 -hash $HASHDIR/bmor1/*.jf >> $LOGDIR/bmor1.log 2>&1 &
	sudo -u nobody $JELFISH -p 48222 -hash $HASHDIR/pombe/*.jf >> $LOGDIR/pombe.log 2>&1 &
	sudo -u nobody $JELFISH -p 48228 -hash $HASHDIR/MG8/*.jf >> $LOGDIR/MG8.log 2>&1 &
	sudo -u nobody $JELFISH -p 48223 -hash $HASHDIR/macaque_CE_1/*.jf >> $LOGDIR/macaque_CE_1.log 2>&1 &
	sudo -u nobody $JELFISH -p 48224 -hash $HASHDIR/KH/*.jf >> $LOGDIR/KH.log 2>&1 &
	sudo -u nobody $JELFISH -p 48225 -hash $HASHDIR/Spur_v3.1/*.jf >> $LOGDIR/Spur_v3.1.log 2>&1 &
	sudo -u nobody $JELFISH -p 48226 -hash $HASHDIR/h7/*.jf >> $LOGDIR/h7.log 2>&1 &
	sudo -u nobody $JELFISH -p 48227 -hash $HASHDIR/Hydra_RP_1.0/*.jf >> $LOGDIR/Hydra_RP_1.0.log 2>&1 &
	sudo -u nobody $JELFISH -p 48229 -hash $HASHDIR/MesAur1.0/*.jf >> $LOGDIR/MesAur1.0.log 2>&1 &
}

StopService ()
{
	ConsoleMessage "Stopping CRISPRdirect jellyfish server"
	kill $(ps -U nobody | sed 's/^\ *//' | grep jellyfishd | cut -d ' ' -f 1)
}

RestartService ()
{
	StopService
	StartService
}

if test -x $JELFISH ; then
	RunService "$1"
else
	ConsoleMessage "Could not find CRISPRdirect jellyfish server script!"
fi
